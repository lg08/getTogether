<!-- login form for users -->
{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block body %}

<div class="container">
    <div class="card mt-5 box-blur">
        <h1 style="margin: 20px 0px;">Log In</h1>
        <form method ="post">
            {% csrf_token %}
            {{ form|crispy }}

            <input type="hidden" id="geolocation" name="userlocation" value="this_from_html" />
            <input style="margin-bottom: 20px;" name="" type="submit" value="Log In" class ="btn btn-primary" />

        </form>

        <p>Don't have an account yet? Sign up <a href="{% url 'users:signup' %}">here!</a></p>

    </div>
</div>

<script>
    let options = {
        enableHighAccuracy: false,
        timeout: 100,
        maximumAge: Infinity
    };

    function success(pos) {
        let crd = pos.coords;
        document.getElementById("geolocation").value = JSON.stringify(crd);
        console.log("Successfully obtained location: " + JSON.stringify(crd))
    }

    function error(err) {
        console.warn(`ERROR(${err.code}): ${err.message}; Could not obtain your location. Default location set to Nassau Hall, Princeton NJ.`);
        let crd = {latitude: 40.34870, longitude: -74.659334}
            document.getElementById("geolocation").value = JSON.stringify(crd);
    }

    function setGeolocation() {
        navigator.geolocation.getCurrentPosition(success, error, options);
    }

    setGeolocation();
</script>

<style>
    #icon {
        border-bottom: thin solid white;
    }


</style>

{% endblock %}
